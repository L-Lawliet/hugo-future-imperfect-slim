<!--
    Inside Double Brackets:
    gallery path="path" file="file" caption="caption" type="type" source="source"
    gallery "path" "file" "caption" "type" "source"
    # of Params: 2-5
    Positional or Named
    position 0, name: path
        Can pass in the following values:
            title: will use /img/LinkTitle as the path
            date: will use /img/Year/Month as the path
            /path/to/img: can pass in explicit path to the image
    position 1, name: file
        Name of the file including the file extension
    position 2, name: caption
        Text for the caption of the image
    position 3, name: type
        Type of frame to use; currently accepts "art"
    position 4, name: source
        Copyright source for figure
-->
{{ $numOfParams := len .Params}}
{{ if and (ge $numOfParams 2) (le $numOfParams 5) }}
  {{ if .IsNamedParams }}
    {{ $.Scratch.Set "path" (.Get "path") }}
    {{ $.Scratch.Set "file" (.Get "file") }}
    {{ $.Scratch.Set "caption"  (.Get "caption") }}
    {{ $.Scratch.Set "type" (.Get "type") }}
    {{ $.Scratch.Set "source"  (.Get "source") }}
  {{ else }}
    {{ $.Scratch.Set "path" (.Get 0) }}
    {{ $.Scratch.Set "file" (.Get 1) }}
    {{ with (.Get 2) }}
      {{ $.Scratch.Set "caption" . }}
    {{ end }}
    {{ with (.Get 3) }}
      {{ $.Scratch.Set "type" . }}
    {{ end }}
    {{ with (.Get 4) }}
      {{ $.Scratch.Set "source" . }}
    {{ end }}
  {{ end }}
  {{ $.Scratch.Set "structType" "shortcode" }}
  {{ $path := $.Scratch.Get "path" }}
  {{ if eq $path "date" }}
    {{ $.Scratch.Set "path" "/img/" }}
    {{ $.Scratch.Add "path" (.Page.Date.Format "2006/01") }}
  {{ end }}
  {{ $path := $.Scratch.Get "path" }}
  {{ $file := $.Scratch.Get "file" }}
  {{ $caption  := $.Scratch.Get "caption" }}
  {{ $type := $.Scratch.Get "type" }}
  {{ $source := $.Scratch.Get "source" }}
  <figure itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
      <div class="gallery{{ with $type }} {{ . }}{{ end }}">
        <a href="{{ path.Join $path $file | relURL }}" itemprop="contentUrl">
          <img src="{{ path.Join $path $file | absURL }}" itemprop="thumbnail" alt="{{ $caption }}">
        </a>
      </div>
    {{ if or $caption $source }}<figcaption itemprop="caption description">{{ with $caption }}{{ .}}{{ end }}{{ with $source }} <cite class="source">{{ . }}</cite>{{ end }}</figcaption>{{ end }}
  </figure>
{{ end }}
